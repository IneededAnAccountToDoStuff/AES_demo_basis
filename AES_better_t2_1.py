#from py_obj_formatter import mrepr

_mult={
(0,1):0,(1,1):1,(2,1):2,(3,1):3,(4,1):4,(5,1):5,(6,1):6,(7,1):7,(8,1):8,(9,1):9,(10,1):10,(11,1):11,(12,1):12,(13,1):13,(14,1):14,(15,1):15,(16,1):16,(17,1):17,(18,1):18,(19,1):19,(20,1):20,(21,1):21,(22,1):22,(23,1):23,(24,1):24,(25,1):25,(26,1):26,(27,1):27,(28,1):28,(29,1):29,(30,1):30,(31,1):31,(32,1):32,(33,1):33,(34,1):34,(35,1):35,(36,1):36,(37,1):37,(38,1):38,(39,1):39,(40,1):40,(41,1):41,(42,1):42,(43,1):43,(44,1):44,(45,1):45,(46,1):46,(47,1):47,(48,1):48,(49,1):49,(50,1):50,(51,1):51,(52,1):52,(53,1):53,(54,1):54,(55,1):55,(56,1):56,(57,1):57,(58,1):58,(59,1):59,(60,1):60,(61,1):61,(62,1):62,(63,1):63,(64,1):64,(65,1):65,(66,1):66,(67,1):67,(68,1):68,(69,1):69,(70,1):70,(71,1):71,(72,1):72,(73,1):73,(74,1):74,(75,1):75,(76,1):76,(77,1):77,(78,1):78,(79,1):79,(80,1):80,(81,1):81,(82,1):82,(83,1):83,(84,1):84,(85,1):85,(86,1):86,(87,1):87,(88,1):88,(89,1):89,(90,1):90,(91,1):91,(92,1):92,(93,1):93,(94,1):94,(95,1):95,(96,1):96,(97,1):97,(98,1):98,(99,1):99,(100,1):100,(101,1):101,(102,1):102,(103,1):103,(104,1):104,(105,1):105,(106,1):106,(107,1):107,(108,1):108,(109,1):109,(110,1):110,(111,1):111,(112,1):112,(113,1):113,(114,1):114,(115,1):115,(116,1):116,(117,1):117,(118,1):118,(119,1):119,(120,1):120,(121,1):121,(122,1):122,(123,1):123,(124,1):124,(125,1):125,(126,1):126,(127,1):127,
(128,1):128,(129,1):129,(130,1):130,(131,1):131,(132,1):132,(133,1):133,(134,1):134,(135,1):135,(136,1):136,(137,1):137,(138,1):138,(139,1):139,(140,1):140,(141,1):141,(142,1):142,(143,1):143,(144,1):144,(145,1):145,(146,1):146,(147,1):147,(148,1):148,(149,1):149,(150,1):150,(151,1):151,(152,1):152,(153,1):153,(154,1):154,(155,1):155,(156,1):156,(157,1):157,(158,1):158,(159,1):159,(160,1):160,(161,1):161,(162,1):162,(163,1):163,(164,1):164,(165,1):165,(166,1):166,(167,1):167,(168,1):168,(169,1):169,(170,1):170,(171,1):171,(172,1):172,(173,1):173,(174,1):174,(175,1):175,(176,1):176,(177,1):177,(178,1):178,(179,1):179,(180,1):180,(181,1):181,(182,1):182,(183,1):183,(184,1):184,(185,1):185,(186,1):186,(187,1):187,(188,1):188,(189,1):189,(190,1):190,(191,1):191,(192,1):192,(193,1):193,(194,1):194,(195,1):195,(196,1):196,(197,1):197,(198,1):198,(199,1):199,(200,1):200,(201,1):201,(202,1):202,(203,1):203,(204,1):204,(205,1):205,(206,1):206,(207,1):207,(208,1):208,(209,1):209,(210,1):210,(211,1):211,(212,1):212,(213,1):213,(214,1):214,(215,1):215,(216,1):216,(217,1):217,(218,1):218,(219,1):219,(220,1):220,(221,1):221,(222,1):222,(223,1):223,(224,1):224,(225,1):225,(226,1):226,(227,1):227,(228,1):228,(229,1):229,(230,1):230,(231,1):231,(232,1):232,(233,1):233,(234,1):234,(235,1):235,(236,1):236,(237,1):237,(238,1):238,(239,1):239,(240,1):240,(241,1):241,(242,1):242,(243,1):243,(244,1):244,(245,1):245,(246,1):246,(247,1):247,(248,1):248,(249,1):249,(250,1):250,(251,1):251,(252,1):252,(253,1):253,(254,1):254,(255,1):255,
(0,2):0,(1,2):2,(2,2):4,(3,2):6,(4,2):8,(5,2):10,(6,2):12,(7,2):14,(8,2):16,(9,2):18,(10,2):20,(11,2):22,(12,2):24,(13,2):26,(14,2):28,(15,2):30,(16,2):32,(17,2):34,(18,2):36,(19,2):38,(20,2):40,(21,2):42,(22,2):44,(23,2):46,(24,2):48,(25,2):50,(26,2):52,(27,2):54,(28,2):56,(29,2):58,(30,2):60,(31,2):62,(32,2):64,(33,2):66,(34,2):68,(35,2):70,(36,2):72,(37,2):74,(38,2):76,(39,2):78,(40,2):80,(41,2):82,(42,2):84,(43,2):86,(44,2):88,(45,2):90,(46,2):92,(47,2):94,(48,2):96,(49,2):98,(50,2):100,(51,2):102,(52,2):104,(53,2):106,(54,2):108,(55,2):110,(56,2):112,(57,2):114,(58,2):116,(59,2):118,(60,2):120,(61,2):122,(62,2):124,(63,2):126,(64,2):128,(65,2):130,(66,2):132,(67,2):134,(68,2):136,(69,2):138,(70,2):140,(71,2):142,(72,2):144,(73,2):146,(74,2):148,(75,2):150,(76,2):152,(77,2):154,(78,2):156,(79,2):158,(80,2):160,(81,2):162,(82,2):164,(83,2):166,(84,2):168,(85,2):170,(86,2):172,(87,2):174,(88,2):176,(89,2):178,(90,2):180,(91,2):182,(92,2):184,(93,2):186,(94,2):188,(95,2):190,(96,2):192,(97,2):194,(98,2):196,(99,2):198,(100,2):200,(101,2):202,(102,2):204,(103,2):206,(104,2):208,(105,2):210,(106,2):212,(107,2):214,(108,2):216,(109,2):218,(110,2):220,(111,2):222,(112,2):224,(113,2):226,(114,2):228,(115,2):230,(116,2):232,(117,2):234,(118,2):236,(119,2):238,(120,2):240,(121,2):242,(122,2):244,(123,2):246,(124,2):248,(125,2):250,(126,2):252,(127,2):254,
(128,2):27,(129,2):25,(130,2):31,(131,2):29,(132,2):19,(133,2):17,(134,2):23,(135,2):21,(136,2):11,(137,2):9,(138,2):15,(139,2):13,(140,2):3,(141,2):1,(142,2):7,(143,2):5,(144,2):59,(145,2):57,(146,2):63,(147,2):61,(148,2):51,(149,2):49,(150,2):55,(151,2):53,(152,2):43,(153,2):41,(154,2):47,(155,2):45,(156,2):35,(157,2):33,(158,2):39,(159,2):37,(160,2):91,(161,2):89,(162,2):95,(163,2):93,(164,2):83,(165,2):81,(166,2):87,(167,2):85,(168,2):75,(169,2):73,(170,2):79,(171,2):77,(172,2):67,(173,2):65,(174,2):71,(175,2):69,(176,2):123,(177,2):121,(178,2):127,(179,2):125,(180,2):115,(181,2):113,(182,2):119,(183,2):117,(184,2):107,(185,2):105,(186,2):111,(187,2):109,(188,2):99,(189,2):97,(190,2):103,(191,2):101,(192,2):155,(193,2):153,(194,2):159,(195,2):157,(196,2):147,(197,2):145,(198,2):151,(199,2):149,(200,2):139,(201,2):137,(202,2):143,(203,2):141,(204,2):131,(205,2):129,(206,2):135,(207,2):133,(208,2):187,(209,2):185,(210,2):191,(211,2):189,(212,2):179,(213,2):177,(214,2):183,(215,2):181,(216,2):171,(217,2):169,(218,2):175,(219,2):173,(220,2):163,(221,2):161,(222,2):167,(223,2):165,(224,2):219,(225,2):217,(226,2):223,(227,2):221,(228,2):211,(229,2):209,(230,2):215,(231,2):213,(232,2):203,(233,2):201,(234,2):207,(235,2):205,(236,2):195,(237,2):193,(238,2):199,(239,2):197,(240,2):251,(241,2):249,(242,2):255,(243,2):253,(244,2):243,(245,2):241,(246,2):247,(247,2):245,(248,2):235,(249,2):233,(250,2):239,(251,2):237,(252,2):227,(253,2):225,(254,2):231,(255,2):229,
(0,3):0,(1,3):3,(2,3):6,(3,3):5,(4,3):12,(5,3):15,(6,3):10,(7,3):9,(8,3):24,(9,3):27,(10,3):30,(11,3):29,(12,3):20,(13,3):23,(14,3):18,(15,3):17,(16,3):48,(17,3):51,(18,3):54,(19,3):53,(20,3):60,(21,3):63,(22,3):58,(23,3):57,(24,3):40,(25,3):43,(26,3):46,(27,3):45,(28,3):36,(29,3):39,(30,3):34,(31,3):33,(32,3):96,(33,3):99,(34,3):102,(35,3):101,(36,3):108,(37,3):111,(38,3):106,(39,3):105,(40,3):120,(41,3):123,(42,3):126,(43,3):125,(44,3):116,(45,3):119,(46,3):114,(47,3):113,(48,3):80,(49,3):83,(50,3):86,(51,3):85,(52,3):92,(53,3):95,(54,3):90,(55,3):89,(56,3):72,(57,3):75,(58,3):78,(59,3):77,(60,3):68,(61,3):71,(62,3):66,(63,3):65,(64,3):192,(65,3):195,(66,3):198,(67,3):197,(68,3):204,(69,3):207,(70,3):202,(71,3):201,(72,3):216,(73,3):219,(74,3):222,(75,3):221,(76,3):212,(77,3):215,(78,3):210,(79,3):209,(80,3):240,(81,3):243,(82,3):246,(83,3):245,(84,3):252,(85,3):255,(86,3):250,(87,3):249,(88,3):232,(89,3):235,(90,3):238,(91,3):237,(92,3):228,(93,3):231,(94,3):226,(95,3):225,(96,3):160,(97,3):163,(98,3):166,(99,3):165,(100,3):172,(101,3):175,(102,3):170,(103,3):169,(104,3):184,(105,3):187,(106,3):190,(107,3):189,(108,3):180,(109,3):183,(110,3):178,(111,3):177,(112,3):144,(113,3):147,(114,3):150,(115,3):149,(116,3):156,(117,3):159,(118,3):154,(119,3):153,(120,3):136,(121,3):139,(122,3):142,(123,3):141,(124,3):132,(125,3):135,(126,3):130,(127,3):129,
(128,3):155,(129,3):152,(130,3):157,(131,3):158,(132,3):151,(133,3):148,(134,3):145,(135,3):146,(136,3):131,(137,3):128,(138,3):133,(139,3):134,(140,3):143,(141,3):140,(142,3):137,(143,3):138,(144,3):171,(145,3):168,(146,3):173,(147,3):174,(148,3):167,(149,3):164,(150,3):161,(151,3):162,(152,3):179,(153,3):176,(154,3):181,(155,3):182,(156,3):191,(157,3):188,(158,3):185,(159,3):186,(160,3):251,(161,3):248,(162,3):253,(163,3):254,(164,3):247,(165,3):244,(166,3):241,(167,3):242,(168,3):227,(169,3):224,(170,3):229,(171,3):230,(172,3):239,(173,3):236,(174,3):233,(175,3):234,(176,3):203,(177,3):200,(178,3):205,(179,3):206,(180,3):199,(181,3):196,(182,3):193,(183,3):194,(184,3):211,(185,3):208,(186,3):213,(187,3):214,(188,3):223,(189,3):220,(190,3):217,(191,3):218,(192,3):91,(193,3):88,(194,3):93,(195,3):94,(196,3):87,(197,3):84,(198,3):81,(199,3):82,(200,3):67,(201,3):64,(202,3):69,(203,3):70,(204,3):79,(205,3):76,(206,3):73,(207,3):74,(208,3):107,(209,3):104,(210,3):109,(211,3):110,(212,3):103,(213,3):100,(214,3):97,(215,3):98,(216,3):115,(217,3):112,(218,3):117,(219,3):118,(220,3):127,(221,3):124,(222,3):121,(223,3):122,(224,3):59,(225,3):56,(226,3):61,(227,3):62,(228,3):55,(229,3):52,(230,3):49,(231,3):50,(232,3):35,(233,3):32,(234,3):37,(235,3):38,(236,3):47,(237,3):44,(238,3):41,(239,3):42,(240,3):11,(241,3):8,(242,3):13,(243,3):14,(244,3):7,(245,3):4,(246,3):1,(247,3):2,(248,3):19,(249,3):16,(250,3):21,(251,3):22,(252,3):31,(253,3):28,(254,3):25,(255,3):26,
(0,9):0,(1,9):9,(2,9):18,(3,9):27,(4,9):36,(5,9):45,(6,9):54,(7,9):63,(8,9):72,(9,9):65,(10,9):90,(11,9):83,(12,9):108,(13,9):101,(14,9):126,(15,9):119,(16,9):144,(17,9):153,(18,9):130,(19,9):139,(20,9):180,(21,9):189,(22,9):166,(23,9):175,(24,9):216,(25,9):209,(26,9):202,(27,9):195,(28,9):252,(29,9):245,(30,9):238,(31,9):231,(32,9):59,(33,9):50,(34,9):41,(35,9):32,(36,9):31,(37,9):22,(38,9):13,(39,9):4,(40,9):115,(41,9):122,(42,9):97,(43,9):104,(44,9):87,(45,9):94,(46,9):69,(47,9):76,(48,9):171,(49,9):162,(50,9):185,(51,9):176,(52,9):143,(53,9):134,(54,9):157,(55,9):148,(56,9):227,(57,9):234,(58,9):241,(59,9):248,(60,9):199,(61,9):206,(62,9):213,(63,9):220,(64,9):118,(65,9):127,(66,9):100,(67,9):109,(68,9):82,(69,9):91,(70,9):64,(71,9):73,(72,9):62,(73,9):55,(74,9):44,(75,9):37,(76,9):26,(77,9):19,(78,9):8,(79,9):1,(80,9):230,(81,9):239,(82,9):244,(83,9):253,(84,9):194,(85,9):203,(86,9):208,(87,9):217,(88,9):174,(89,9):167,(90,9):188,(91,9):181,(92,9):138,(93,9):131,(94,9):152,(95,9):145,(96,9):77,(97,9):68,(98,9):95,(99,9):86,(100,9):105,(101,9):96,(102,9):123,(103,9):114,(104,9):5,(105,9):12,(106,9):23,(107,9):30,(108,9):33,(109,9):40,(110,9):51,(111,9):58,(112,9):221,(113,9):212,(114,9):207,(115,9):198,(116,9):249,(117,9):240,(118,9):235,(119,9):226,(120,9):149,(121,9):156,(122,9):135,(123,9):142,(124,9):177,(125,9):184,(126,9):163,(127,9):170,
(128,9):236,(129,9):229,(130,9):254,(131,9):247,(132,9):200,(133,9):193,(134,9):218,(135,9):211,(136,9):164,(137,9):173,(138,9):182,(139,9):191,(140,9):128,(141,9):137,(142,9):146,(143,9):155,(144,9):124,(145,9):117,(146,9):110,(147,9):103,(148,9):88,(149,9):81,(150,9):74,(151,9):67,(152,9):52,(153,9):61,(154,9):38,(155,9):47,(156,9):16,(157,9):25,(158,9):2,(159,9):11,(160,9):215,(161,9):222,(162,9):197,(163,9):204,(164,9):243,(165,9):250,(166,9):225,(167,9):232,(168,9):159,(169,9):150,(170,9):141,(171,9):132,(172,9):187,(173,9):178,(174,9):169,(175,9):160,(176,9):71,(177,9):78,(178,9):85,(179,9):92,(180,9):99,(181,9):106,(182,9):113,(183,9):120,(184,9):15,(185,9):6,(186,9):29,(187,9):20,(188,9):43,(189,9):34,(190,9):57,(191,9):48,(192,9):154,(193,9):147,(194,9):136,(195,9):129,(196,9):190,(197,9):183,(198,9):172,(199,9):165,(200,9):210,(201,9):219,(202,9):192,(203,9):201,(204,9):246,(205,9):255,(206,9):228,(207,9):237,(208,9):10,(209,9):3,(210,9):24,(211,9):17,(212,9):46,(213,9):39,(214,9):60,(215,9):53,(216,9):66,(217,9):75,(218,9):80,(219,9):89,(220,9):102,(221,9):111,(222,9):116,(223,9):125,(224,9):161,(225,9):168,(226,9):179,(227,9):186,(228,9):133,(229,9):140,(230,9):151,(231,9):158,(232,9):233,(233,9):224,(234,9):251,(235,9):242,(236,9):205,(237,9):196,(238,9):223,(239,9):214,(240,9):49,(241,9):56,(242,9):35,(243,9):42,(244,9):21,(245,9):28,(246,9):7,(247,9):14,(248,9):121,(249,9):112,(250,9):107,(251,9):98,(252,9):93,(253,9):84,(254,9):79,(255,9):70,
(0,11):0,(1,11):11,(2,11):22,(3,11):29,(4,11):44,(5,11):39,(6,11):58,(7,11):49,(8,11):88,(9,11):83,(10,11):78,(11,11):69,(12,11):116,(13,11):127,(14,11):98,(15,11):105,(16,11):176,(17,11):187,(18,11):166,(19,11):173,(20,11):156,(21,11):151,(22,11):138,(23,11):129,(24,11):232,(25,11):227,(26,11):254,(27,11):245,(28,11):196,(29,11):207,(30,11):210,(31,11):217,(32,11):123,(33,11):112,(34,11):109,(35,11):102,(36,11):87,(37,11):92,(38,11):65,(39,11):74,(40,11):35,(41,11):40,(42,11):53,(43,11):62,(44,11):15,(45,11):4,(46,11):25,(47,11):18,(48,11):203,(49,11):192,(50,11):221,(51,11):214,(52,11):231,(53,11):236,(54,11):241,(55,11):250,(56,11):147,(57,11):152,(58,11):133,(59,11):142,(60,11):191,(61,11):180,(62,11):169,(63,11):162,(64,11):246,(65,11):253,(66,11):224,(67,11):235,(68,11):218,(69,11):209,(70,11):204,(71,11):199,(72,11):174,(73,11):165,(74,11):184,(75,11):179,(76,11):130,(77,11):137,(78,11):148,(79,11):159,(80,11):70,(81,11):77,(82,11):80,(83,11):91,(84,11):106,(85,11):97,(86,11):124,(87,11):119,(88,11):30,(89,11):21,(90,11):8,(91,11):3,(92,11):50,(93,11):57,(94,11):36,(95,11):47,(96,11):141,(97,11):134,(98,11):155,(99,11):144,(100,11):161,(101,11):170,(102,11):183,(103,11):188,(104,11):213,(105,11):222,(106,11):195,(107,11):200,(108,11):249,(109,11):242,(110,11):239,(111,11):228,(112,11):61,(113,11):54,(114,11):43,(115,11):32,(116,11):17,(117,11):26,(118,11):7,(119,11):12,(120,11):101,(121,11):110,(122,11):115,(123,11):120,(124,11):73,(125,11):66,(126,11):95,(127,11):84,
(128,11):247,(129,11):252,(130,11):225,(131,11):234,(132,11):219,(133,11):208,(134,11):205,(135,11):198,(136,11):175,(137,11):164,(138,11):185,(139,11):178,(140,11):131,(141,11):136,(142,11):149,(143,11):158,(144,11):71,(145,11):76,(146,11):81,(147,11):90,(148,11):107,(149,11):96,(150,11):125,(151,11):118,(152,11):31,(153,11):20,(154,11):9,(155,11):2,(156,11):51,(157,11):56,(158,11):37,(159,11):46,(160,11):140,(161,11):135,(162,11):154,(163,11):145,(164,11):160,(165,11):171,(166,11):182,(167,11):189,(168,11):212,(169,11):223,(170,11):194,(171,11):201,(172,11):248,(173,11):243,(174,11):238,(175,11):229,(176,11):60,(177,11):55,(178,11):42,(179,11):33,(180,11):16,(181,11):27,(182,11):6,(183,11):13,(184,11):100,(185,11):111,(186,11):114,(187,11):121,(188,11):72,(189,11):67,(190,11):94,(191,11):85,(192,11):1,(193,11):10,(194,11):23,(195,11):28,(196,11):45,(197,11):38,(198,11):59,(199,11):48,(200,11):89,(201,11):82,(202,11):79,(203,11):68,(204,11):117,(205,11):126,(206,11):99,(207,11):104,(208,11):177,(209,11):186,(210,11):167,(211,11):172,(212,11):157,(213,11):150,(214,11):139,(215,11):128,(216,11):233,(217,11):226,(218,11):255,(219,11):244,(220,11):197,(221,11):206,(222,11):211,(223,11):216,(224,11):122,(225,11):113,(226,11):108,(227,11):103,(228,11):86,(229,11):93,(230,11):64,(231,11):75,(232,11):34,(233,11):41,(234,11):52,(235,11):63,(236,11):14,(237,11):5,(238,11):24,(239,11):19,(240,11):202,(241,11):193,(242,11):220,(243,11):215,(244,11):230,(245,11):237,(246,11):240,(247,11):251,(248,11):146,(249,11):153,(250,11):132,(251,11):143,(252,11):190,(253,11):181,(254,11):168,(255,11):163,
(0,13):0,(1,13):13,(2,13):26,(3,13):23,(4,13):52,(5,13):57,(6,13):46,(7,13):35,(8,13):104,(9,13):101,(10,13):114,(11,13):127,(12,13):92,(13,13):81,(14,13):70,(15,13):75,(16,13):208,(17,13):221,(18,13):202,(19,13):199,(20,13):228,(21,13):233,(22,13):254,(23,13):243,(24,13):184,(25,13):181,(26,13):162,(27,13):175,(28,13):140,(29,13):129,(30,13):150,(31,13):155,(32,13):187,(33,13):182,(34,13):161,(35,13):172,(36,13):143,(37,13):130,(38,13):149,(39,13):152,(40,13):211,(41,13):222,(42,13):201,(43,13):196,(44,13):231,(45,13):234,(46,13):253,(47,13):240,(48,13):107,(49,13):102,(50,13):113,(51,13):124,(52,13):95,(53,13):82,(54,13):69,(55,13):72,(56,13):3,(57,13):14,(58,13):25,(59,13):20,(60,13):55,(61,13):58,(62,13):45,(63,13):32,(64,13):109,(65,13):96,(66,13):119,(67,13):122,(68,13):89,(69,13):84,(70,13):67,(71,13):78,(72,13):5,(73,13):8,(74,13):31,(75,13):18,(76,13):49,(77,13):60,(78,13):43,(79,13):38,(80,13):189,(81,13):176,(82,13):167,(83,13):170,(84,13):137,(85,13):132,(86,13):147,(87,13):158,(88,13):213,(89,13):216,(90,13):207,(91,13):194,(92,13):225,(93,13):236,(94,13):251,(95,13):246,(96,13):214,(97,13):219,(98,13):204,(99,13):193,(100,13):226,(101,13):239,(102,13):248,(103,13):245,(104,13):190,(105,13):179,(106,13):164,(107,13):169,(108,13):138,(109,13):135,(110,13):144,(111,13):157,(112,13):6,(113,13):11,(114,13):28,(115,13):17,(116,13):50,(117,13):63,(118,13):40,(119,13):37,(120,13):110,(121,13):99,(122,13):116,(123,13):121,(124,13):90,(125,13):87,(126,13):64,(127,13):77,
(128,13):218,(129,13):215,(130,13):192,(131,13):205,(132,13):238,(133,13):227,(134,13):244,(135,13):249,(136,13):178,(137,13):191,(138,13):168,(139,13):165,(140,13):134,(141,13):139,(142,13):156,(143,13):145,(144,13):10,(145,13):7,(146,13):16,(147,13):29,(148,13):62,(149,13):51,(150,13):36,(151,13):41,(152,13):98,(153,13):111,(154,13):120,(155,13):117,(156,13):86,(157,13):91,(158,13):76,(159,13):65,(160,13):97,(161,13):108,(162,13):123,(163,13):118,(164,13):85,(165,13):88,(166,13):79,(167,13):66,(168,13):9,(169,13):4,(170,13):19,(171,13):30,(172,13):61,(173,13):48,(174,13):39,(175,13):42,(176,13):177,(177,13):188,(178,13):171,(179,13):166,(180,13):133,(181,13):136,(182,13):159,(183,13):146,(184,13):217,(185,13):212,(186,13):195,(187,13):206,(188,13):237,(189,13):224,(190,13):247,(191,13):250,(192,13):183,(193,13):186,(194,13):173,(195,13):160,(196,13):131,(197,13):142,(198,13):153,(199,13):148,(200,13):223,(201,13):210,(202,13):197,(203,13):200,(204,13):235,(205,13):230,(206,13):241,(207,13):252,(208,13):103,(209,13):106,(210,13):125,(211,13):112,(212,13):83,(213,13):94,(214,13):73,(215,13):68,(216,13):15,(217,13):2,(218,13):21,(219,13):24,(220,13):59,(221,13):54,(222,13):33,(223,13):44,(224,13):12,(225,13):1,(226,13):22,(227,13):27,(228,13):56,(229,13):53,(230,13):34,(231,13):47,(232,13):100,(233,13):105,(234,13):126,(235,13):115,(236,13):80,(237,13):93,(238,13):74,(239,13):71,(240,13):220,(241,13):209,(242,13):198,(243,13):203,(244,13):232,(245,13):229,(246,13):242,(247,13):255,(248,13):180,(249,13):185,(250,13):174,(251,13):163,(252,13):128,(253,13):141,(254,13):154,(255,13):151,
(0,14):0,(1,14):14,(2,14):28,(3,14):18,(4,14):56,(5,14):54,(6,14):36,(7,14):42,(8,14):112,(9,14):126,(10,14):108,(11,14):98,(12,14):72,(13,14):70,(14,14):84,(15,14):90,(16,14):224,(17,14):238,(18,14):252,(19,14):242,(20,14):216,(21,14):214,(22,14):196,(23,14):202,(24,14):144,(25,14):158,(26,14):140,(27,14):130,(28,14):168,(29,14):166,(30,14):180,(31,14):186,(32,14):219,(33,14):213,(34,14):199,(35,14):201,(36,14):227,(37,14):237,(38,14):255,(39,14):241,(40,14):171,(41,14):165,(42,14):183,(43,14):185,(44,14):147,(45,14):157,(46,14):143,(47,14):129,(48,14):59,(49,14):53,(50,14):39,(51,14):41,(52,14):3,(53,14):13,(54,14):31,(55,14):17,(56,14):75,(57,14):69,(58,14):87,(59,14):89,(60,14):115,(61,14):125,(62,14):111,(63,14):97,(64,14):173,(65,14):163,(66,14):177,(67,14):191,(68,14):149,(69,14):155,(70,14):137,(71,14):135,(72,14):221,(73,14):211,(74,14):193,(75,14):207,(76,14):229,(77,14):235,(78,14):249,(79,14):247,(80,14):77,(81,14):67,(82,14):81,(83,14):95,(84,14):117,(85,14):123,(86,14):105,(87,14):103,(88,14):61,(89,14):51,(90,14):33,(91,14):47,(92,14):5,(93,14):11,(94,14):25,(95,14):23,(96,14):118,(97,14):120,(98,14):106,(99,14):100,(100,14):78,(101,14):64,(102,14):82,(103,14):92,(104,14):6,(105,14):8,(106,14):26,(107,14):20,(108,14):62,(109,14):48,(110,14):34,(111,14):44,(112,14):150,(113,14):152,(114,14):138,(115,14):132,(116,14):174,(117,14):160,(118,14):178,(119,14):188,(120,14):230,(121,14):232,(122,14):250,(123,14):244,(124,14):222,(125,14):208,(126,14):194,(127,14):204,
(128,14):65,(129,14):79,(130,14):93,(131,14):83,(132,14):121,(133,14):119,(134,14):101,(135,14):107,(136,14):49,(137,14):63,(138,14):45,(139,14):35,(140,14):9,(141,14):7,(142,14):21,(143,14):27,(144,14):161,(145,14):175,(146,14):189,(147,14):179,(148,14):153,(149,14):151,(150,14):133,(151,14):139,(152,14):209,(153,14):223,(154,14):205,(155,14):195,(156,14):233,(157,14):231,(158,14):245,(159,14):251,(160,14):154,(161,14):148,(162,14):134,(163,14):136,(164,14):162,(165,14):172,(166,14):190,(167,14):176,(168,14):234,(169,14):228,(170,14):246,(171,14):248,(172,14):210,(173,14):220,(174,14):206,(175,14):192,(176,14):122,(177,14):116,(178,14):102,(179,14):104,(180,14):66,(181,14):76,(182,14):94,(183,14):80,(184,14):10,(185,14):4,(186,14):22,(187,14):24,(188,14):50,(189,14):60,(190,14):46,(191,14):32,(192,14):236,(193,14):226,(194,14):240,(195,14):254,(196,14):212,(197,14):218,(198,14):200,(199,14):198,(200,14):156,(201,14):146,(202,14):128,(203,14):142,(204,14):164,(205,14):170,(206,14):184,(207,14):182,(208,14):12,(209,14):2,(210,14):16,(211,14):30,(212,14):52,(213,14):58,(214,14):40,(215,14):38,(216,14):124,(217,14):114,(218,14):96,(219,14):110,(220,14):68,(221,14):74,(222,14):88,(223,14):86,(224,14):55,(225,14):57,(226,14):43,(227,14):37,(228,14):15,(229,14):1,(230,14):19,(231,14):29,(232,14):71,(233,14):73,(234,14):91,(235,14):85,(236,14):127,(237,14):113,(238,14):99,(239,14):109,(240,14):215,(241,14):217,(242,14):203,(243,14):197,(244,14):239,(245,14):225,(246,14):243,(247,14):253,(248,14):167,(249,14):169,(250,14):187,(251,14):181,(252,14):159,(253,14):145,(254,14):131,(255,14):141,
}
# print(len(_mult));exit()

#TODO: test full _mult table speed
#https://legacy.cryptool.org/en/cto/aes-step-by-step
#https://jrvidal.github.io/aes-demo/ http://aes.online-domain-tools.com/
sbox=(99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22)
unsbox=(82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125)
def listxortri(a,b,c):return[i^j^k for i,j,k in zip(a,b,c)]
def listxor(a,b):return[i^j for i,j in zip(a,b)]
def rcongen(x):
    yield 1;v=[1]
    for i in range(2,x+1):p=v[-1];c=2*p^(283*(p>=128));v.append(c);yield c

def rot(word):return(word[1],word[2],word[3],word[0])
def sub(word):return(sbox[word[0]],sbox[word[1]],sbox[word[2]],sbox[word[3]])
#TODO: array module based version, _t3
def keygenerate(key,level=128,rconlist=[*rcongen(10)]):
    N={128:4,192:6,256:8}[level];R=N+7;K=key.rjust(level//8,b'\x00');W=[K[i:i+4]for i in range(0,4*N,4)];c=W[-1];Wc=W.append
    for i in range(N,4*R):
        if i%N==0:c=listxortri(W[i-N],sub(rot(c)),[rconlist[i//N-1],0,0,0])
        elif N>6 and i%N==4:c=listxor(W[i-N],sub(c))
        else:c=listxor(W[i-N],c)
        Wc(c)
    return[[i for j in W[i:i+4]for i in j]for i in range(0,4*R,4)]

def shiftrows(d):return(d[0],d[1],d[2],d[3],d[5],d[6],d[7],d[4],d[10],d[11],d[8],d[9],d[15],d[12],d[13],d[14])
def unshiftrows(d):return(d[0],d[1],d[2],d[3],d[7],d[4],d[5],d[6],d[10],d[11],d[8],d[9],d[13],d[14],d[15],d[12])
def mixcolumns(data):a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q=data;return(_mult[a,2]^_mult[e,3]^_mult[j,1]^_mult[n,1],_mult[b,2]^_mult[f,3]^_mult[k,1]^_mult[o,1],_mult[c,2]^_mult[g,3]^_mult[l,1]^_mult[p,1],_mult[d,2]^_mult[h,3]^_mult[m,1]^_mult[q,1],_mult[a,1]^_mult[e,2]^_mult[j,3]^_mult[n,1],_mult[b,1]^_mult[f,2]^_mult[k,3]^_mult[o,1],_mult[c,1]^_mult[g,2]^_mult[l,3]^_mult[p,1],_mult[d,1]^_mult[h,2]^_mult[m,3]^_mult[q,1],_mult[a,1]^_mult[e,1]^_mult[j,2]^_mult[n,3],_mult[b,1]^_mult[f,1]^_mult[k,2]^_mult[o,3],_mult[c,1]^_mult[g,1]^_mult[l,2]^_mult[p,3],_mult[d,1]^_mult[h,1]^_mult[m,2]^_mult[q,3],_mult[a,3]^_mult[e,1]^_mult[j,1]^_mult[n,2],_mult[b,3]^_mult[f,1]^_mult[k,1]^_mult[o,2],_mult[c,3]^_mult[g,1]^_mult[l,1]^_mult[p,2],_mult[d,3]^_mult[h,1]^_mult[m,1]^_mult[q,2])
def unmixcolumns(data):a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q=data;return(_mult[a,14]^_mult[e,11]^_mult[j,13]^_mult[n,9],_mult[b,14]^_mult[f,11]^_mult[k,13]^_mult[o,9],_mult[c,14]^_mult[g,11]^_mult[l,13]^_mult[p,9],_mult[d,14]^_mult[h,11]^_mult[m,13]^_mult[q,9],_mult[a,9]^_mult[e,14]^_mult[j,11]^_mult[n,13],_mult[b,9]^_mult[f,14]^_mult[k,11]^_mult[o,13],_mult[c,9]^_mult[g,14]^_mult[l,11]^_mult[p,13],_mult[d,9]^_mult[h,14]^_mult[m,11]^_mult[q,13],_mult[a,13]^_mult[e,9]^_mult[j,14]^_mult[n,11],_mult[b,13]^_mult[f,9]^_mult[k,14]^_mult[o,11],_mult[c,13]^_mult[g,9]^_mult[l,14]^_mult[p,11],_mult[d,13]^_mult[h,9]^_mult[m,14]^_mult[q,11],_mult[a,11]^_mult[e,13]^_mult[j,9]^_mult[n,14],_mult[b,11]^_mult[f,13]^_mult[k,9]^_mult[o,14],_mult[c,11]^_mult[g,13]^_mult[l,9]^_mult[p,14],_mult[d,11]^_mult[h,13]^_mult[m,9]^_mult[q,14])

def aes_block(data,keygen,level=128):
   c=data;rounds={128:9,192:11,256:13}[level];roundkeygen=iter(keygen);c=listxor(c,next(roundkeygen))
   for _ in range(rounds):c=listxor(mixcolumns(shiftrows([sbox[i]for i in c])),next(roundkeygen))
   return bytes((listxor(shiftrows([sbox[i]for i in c]),next(roundkeygen))))
def aes_unblock(data,keygen,level=128):
    c=data;rounds={128:9,192:11,256:13}[level];roundkeygen=iter(reversed(keygen))
    c=[unsbox[i]for i in unshiftrows(listxor(c,next(roundkeygen)))]
    for _ in range(rounds):c=[unsbox[i]for i in unshiftrows(unmixcolumns(listxor(c,next(roundkeygen))))]
    return bytes((listxor(c,next(roundkeygen))))
def AES_encrypt(data:bytes,key:bytes,level:int=128):
    data=b'\x01'+data;s=len(data)
    while s%16:data=b'\x00'+data;s+=1
    keygen=keygenerate(key,level)
    # dat=memoryview(data)
    return b''.join(aes_block(data[i:i+16],keygen,level)for i in range(0,s,16))
def AES_decrypt(data:bytes,key:bytes,level:int=128):
    keygen=keygenerate(key,level)
    # dat=memoryview(data)
    c=b''.join(aes_unblock(data[i:i+16],keygen,level)for i in range(0,len(data),16))
    return c[c.index(b'\x01')+1:]

def hexs(a,mis=None):
    a=a.upper()
    if mis is not None:a=f'{a:>0{mis}}'
    return' '.join(a[i:i+2]for i in range(0,len(a),2))
if'__main__'==__name__ or 1:
    from time import time as timen
    # key=b'boh'#b'1'*16
    # level=128
    # testmag=b'Samantha Davis the III'#b'Samanthq23a'#b'Samantha'
    #
    # #for i,v in enumerate(keygenerate(key,level=level)):print(f'Key {i:>X}: {' '.join(f'{e:02X}'for e in v)}')
    # print(f'key_hex = {hexs(key.hex(),32)}\nmessage = {hexs(testmag.hex(),32)}\n\n')
    # d=AES_encrypt(testmag,key,level=level)
    # assert AES_decrypt(d,key,level=level)==testmag
    # print('Decrypt successful')
    # import AES_better_t2 as sampleAES
    # assert sampleAES.AES_encrypt(testmag,key,level=level)==d,(sampleAES.AES_encrypt(testmag,key,level=level).hex(),d.hex())
    # print('Encryption valid')
    # print(f'Encrypted step: {hexs(d.hex().upper())}')
    A=b'\x00'*(2**20)
    A=b'\x00'*16000000
    # A=b'Hello World'
    print('Stress test started')
    t1=timen()
    a=AES_encrypt(A,b'\x00'*128,128)#(A,b'\x00'*256,256)
    b=AES_decrypt(a,b'\x00'*128,128)#(a,b'\x00'*256,256)
    t2=timen()
    td=t2-t1
    print('Stress test ended')
    print(f'Time: {round(td,4)}')
    assert A==b

# #TODO: fast implementation
# #TODO: block mode cipher
#
# #https://proandroiddev.com/security-best-practices-symmetric-encryption-with-aes-in-java-7616beaaade9
# #https://crypto.stackexchange.com/questions/44672/different-ways-algorithms-for-implementing-aes/44675#44675
# #https://blog.tclaverie.eu/posts/understanding-golangs-aes-implementation-t-tables/
